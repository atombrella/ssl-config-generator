# {{output.header}}
# {{{output.link}}}

batch
/subsystem=elytron/server-ssl-context=applicationSSC:write-attribute(name=protocols,value=[])
{{#if (includes "modern" form.config)}}
/subsystem=elytron/server-ssl-context=applicationSSC:write-attribute(name=cipher-suite-name,value=[{{{join output.ciphers ":"}}}])
{{else}}
/subsystem=elytron/server-ssl-context=applicationSSC:write-attribute(name=cipher-suite-filter,value=[{{{join output.ciphers ":"}}}])
{{/if}}

{{#if form.ocsp }}
/subsystem=elytron/trust-manager=applicationSSC:write-attribute(name=ocsp,value=true)
{{/if}}

{{#if form.hsts}}
/subsystem=undertow/configuration=filter/response-header=new-response-header:add(header-name="Strict-Transport-Security",header-value="max-age=31536000; includeSubDomains;")
{{/if}}

:run-batch
